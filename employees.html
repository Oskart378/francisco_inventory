<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management - Francisco is Cooking for You</title>
    <link rel="stylesheet" href="styles.css">
    <script src="export.js" defer></script> <!-- Load export script -->
</head>
<body>
    <header>
        <h1>Francisco is Cooking for You</h1>
        <nav id="nav">
            <!-- Links will be injected by script -->
        </nav>
        <button id="download-btn">Download as Excel</button>
        <button id="logout-btn">Logout</button>
    </header>
    
    <div class="container">
        <!-- Form to add/edit employees -->
        <form id="employee-form">
            <input type="text" id="employee-name" placeholder="Employee Name" required>
            <input type="number" id="weekly-pay" placeholder="Weekly Pay" min="0" step="0.01" required>
            <button type="submit" id="add-employee-btn">Add Employee</button>
            <button type="button" id="update-employee-btn" style="display: none;">Update Employee</button>
            <button type="button" id="cancel-employee-btn" style="display: none;">Cancel</button>
        </form>
        
        <!-- Table to display employees -->
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Weekly Pay</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="employee-list"></tbody>
            <tfoot>
                <tr>
                    <td colspan="1" class="total-text">Total Pay:</td>
                    <td id="total-pay">$0.00</td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <script src="nav.js"></script>
    <script src="employee.js"></script>

<!-- <script>
    document.addEventListener('DOMContentLoaded', () => {
        const downloadBtn = document.getElementById('download-btn');

        downloadBtn.addEventListener('click', () => {
            // Create a new workbook
            const wb = XLSX.utils.book_new();

            // Get table data
            const table = document.querySelector('table');
            const rows = Array.from(table.querySelectorAll('tr'));

            // Create a new array to hold table data
            const dataWithoutActions = rows.map(row => {
                const cells = Array.from(row.querySelectorAll('td, th'));
                // Remove the last cell (Actions column)
                if (cells.length > 2) cells.pop();
                return cells.map(cell => cell.textContent.trim());
            });

            // Calculate Total Pay
            const totalPayElement = document.getElementById('total-pay');
            const totalPay = totalPayElement ? totalPayElement.textContent.trim() : '$0.00';

            // Create a worksheet from the processed data
            const ws = XLSX.utils.aoa_to_sheet(dataWithoutActions);

            // Set column widths
            ws['!cols'] = [
                { width: 30 }, // Adjust width for the Name column
                { width: 15 }  // Adjust width for the Weekly Pay column
            ];

            // Add "Total Pay" row to the worksheet
            const totalRowIndex = dataWithoutActions.length + 1; // Add one for the total pay row

            ws[`A${totalRowIndex + 1}`] = {
                v: 'Total Pay:',
                s: {
                    font: { bold: true, sz: 14 } // Bold and larger font size for "Total Pay"
                }
            };

            ws[`B${totalRowIndex + 1}`] = {
                v: totalPay, // Total pay amount
                s: {
                    font: { bold: true, sz: 16 } // Bold and larger font size for total pay amount
                }
            };

            // Append the sheet to the workbook
            XLSX.utils.book_append_sheet(wb, ws, 'Employees');

            // Generate binary data and create a blob
            const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
            const buf = new ArrayBuffer(wbout.length);
            const view = new Uint8Array(buf);
            for (let i = 0; i < wbout.length; i++) view[i] = wbout.charCodeAt(i) & 0xFF;
            const blob = new Blob([buf], { type: 'application/octet-stream' });
            const url = URL.createObjectURL(blob);

            // Create a download link and trigger the download
            const a = document.createElement('a');
            a.href = url;
            a.download = 'employee_management.xlsx';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url); // Clean up the URL object
        });
    });
</script> -->

</body>
</html>
